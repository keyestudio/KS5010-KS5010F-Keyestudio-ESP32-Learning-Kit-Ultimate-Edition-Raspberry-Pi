# Project 39: WiFi Test

1.  Introduction：
    
    In this experiment, we first use the WiFi station mode of ESP32 to
    read the IP address of WiFi, and then connect WiFi through app to
    read the characters sent by each function button on App.
    
    2.Components：

<table>
<tbody>
<tr class="odd">
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5010-KS5010F-Keyestudio-ESP32-Learning-Kit-Ultimate-Edition-Raspberry-Pi/master/media/729232b0c2d2c01984808289b222890c.png" style="width:1.8125in;height:0.86458in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5010-KS5010F-Keyestudio-ESP32-Learning-Kit-Ultimate-Edition-Raspberry-Pi/master/media/27f4c7f6c0855000ba007934d00c4a79.jpeg" style="width:2.43681in;height:1.13472in" /></td>
<td><img src="https://raw.githubusercontent.com/keyestudio/KS5010-KS5010F-Keyestudio-ESP32-Learning-Kit-Ultimate-Edition-Raspberry-Pi/master/media/41abce34fdbca029fdea842bba8208c0.png" style="width:0.63194in;height:1.25972in" /><img src="https://raw.githubusercontent.com/keyestudio/KS5010-KS5010F-Keyestudio-ESP32-Learning-Kit-Ultimate-Edition-Raspberry-Pi/master/media/3567b7cbf98e20010044a1133bab78b7.png" style="width:1.72847in;height:1.02778in" /></td>
</tr>
<tr class="even">
<td>USB Cable*1</td>
<td>ESP32*1</td>
<td>Smartphone/Tablet *1</td>
</tr>
</tbody>
</table>

3.Wiring：

Connect the ESP32 to the USB port on your raspberry pi using a USB
cable.

![](/media/56053f7126905c6def63919c661d5c0a.jpeg)

4.Install APP:

Android system (Smartphone/Tablet) APP:

We provide the Android APP installation package：

![](/media/c8d89f132571775e82a6fedbd075200c.png)

Installation steps：

Now transfer the **keyes wifi.apk** file in the folder to android phone
or tablet, click **keyes wifi.apk** file to enter the installation page,
click“ALLOW”, then click“INSTALL”, after a while, click“OPEN”after the
installation is completed to enter the APP interface.

![](/media/d620452a9d6188cb3946269510df5ae0.png)

![](/media/b311329042f5bbd2880841127b91ebf8.png)

![](/media/7c5cfc935371c8e2ab30e999775d5f8f.png)

![](/media/d48c065ebaf1c5ca652eb72b15d3e596.png)

![](/media/78c89b91c0af2268f6267813e7923a9b.png)

IOS system (Smartphone/Tablet) APP:

a.Open App Store.

![](/media/27924fdb3d67692df7c63d8d0fb72287.png)

b. Enter keyes link in the search box and click Search. The download
interface appears. Click“![](/media/962a57f92b78eea1f0e3e81463497a9c.png)”to download and install
the APP of keyes link. The following operations are similar to those of
Android system, you can refer to the steps of Android system above for
operation.

3.  Project code：

You can open the code we provide：

The code used in this project is saved in folder(path:) **“3. Raspberry
Pi System\\C\_Tutorial\\2.Projects\\Project 39：WiFi
Test\\Project\_39\_WiFi\_Test”**.

    //**********************************************************************************
    /*
     * Filename    : WIFI Test
     * Description : Wifi module test the ip of Wifi
     * Auther      : http//www.keyestudio.com
    */
    // generated by KidsBlock
    #include <Arduino.h>
    #include <WiFi.h>
    #include <ESPmDNS.h>
    #include <WiFiClient.h>
    
    String item = "0";
    const char* ssid = "ChinaNet-2.4G-0DF0";
    const char* password = "ChinaNet@233";
    WiFiServer server(80);
    
    void setup() {
      Serial.begin(115200);
      WiFi.begin(ssid, password);
      while (WiFi.status() != WL_CONNECTED) {
        delay(500);
        Serial.print(".");
      }
      Serial.println("");
      Serial.print("Connected to ");
      Serial.println(ssid);
      Serial.print("IP address: ");
      Serial.println(WiFi.localIP());
      server.begin();
      Serial.println("TCP server started");
      MDNS.addService("http", "tcp", 80);
    }
    
    void loop() {
      WiFiClient client = server.available();
      if (!client) {
          return;
      }
      while(client.connected() && !client.available()){
          delay(1);
      }
      String req = client.readStringUntil('\r');
      int addr_start = req.indexOf(' ');
      int addr_end = req.indexOf(' ', addr_start + 1);
      if (addr_start == -1 || addr_end == -1) {
          Serial.print("Invalid request: ");
          Serial.println(req);
          return;
      }
      req = req.substring(addr_start + 1, addr_end);
      item=req;
      Serial.println(item);
      String s;
      if (req == "/")
      {
          IPAddress ip = WiFi.localIP();
          String ipStr = String(ip[0]) + '.' + String(ip[1]) + '.' + String(ip[2]) + '.' + String(ip[3]);
          s = "HTTP/1.1 200 OK\r\nContent-Type: text/html\r\n\r\n<!DOCTYPE HTML>\r\n<html>Hello from ESP32 at ";
          s += ipStr;
          s += "</html>\r\n\r\n";
          Serial.println("Sending 200");
          client.println(s);
      }
      //client.print(s);
      client.stop();
    }
    //**********************************************************************************


**Special attention:** you need to change the user's Wifi name and Wifi
password in the experiment code![](/media/85551285d37d87fc8decadc09f968ec3.png)to your own Wifi
name and Wifi password.

5. Project result：

After making sure that the Code is modified correctly, compile and
upload the code to ESP32.（**Note:** If uploading the code fails, you can
press the Boot button on ESP32 after click![](/media/d09c4a31563f04a42d451e7bc1a5fb8a.png), and
release the Boot button![](/media/dc77bfcf5851c8f43aab6cbe7cec7920.png) after the percentage of
uploading progress appears），open the serial monitor and set baud rate to
115200. You need to press the reset button on the ESP32 mainboard
first.In this way, the serial port monitor prints the detected WiFi IP
address, then open the WiFi APP and enter the detected WiFi IP address
in the text box in front of the WiFi button (for example, the IP address
shown by the serial port monitor below :192.168.0.119), then click the
WiFi button.“403 Forbidden”or“Webpage not available”will change
to“192.168.0.119”, indicating that the APP is already connected to
WiFi.

![](/media/8313b73eaff11b2bfc2f854cefe0a9f8.jpeg)

Click each function button on the APP by hand, and then the serial port
monitor will print the corresponding characters received. (If open the
serial monitor and set the baud rate to 115200, the information is not
displayed, please press the RESET button of the ESP32)

![](/media/1fd21fafd84d2b529931a89d21a03d6a.png))

![](/media/67e6b070bf06ac98d943fd1826be258f.png)
